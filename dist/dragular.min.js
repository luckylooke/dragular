!function(){"use strict";angular.module("dragularModule",["dragularService","dragularDirective"]);var e={classesCache:{},containersCtx:{},containers:{},mirror:null,source:null,item:null,copy:null,sourceItem:null,sourceModel:null,sourceFilteredModel:null,target:null,targetCtx:null,targetModel:null,lastDropTarget:null,offsetX:null,offsetY:null,moveX:null,moveY:null,offsetXr:null,offsetYb:null,clientX:null,clientY:null,mirrorWidth:null,mirrorHeight:null,initialSibling:null,currentSibling:null,initialIndex:null,currentIndex:null,tempModel:null,dragOverEvents:{},lastElementBehindCursor:null,grabbed:null};angular.module("dragular").factory("dragularService",function(r){function t(t,u){function v(){1!==arguments.length||Array.isArray(t)||angular.isElement(t)||t[0]||"string"==typeof t?"string"==typeof t&&(ie=document.querySelectorAll(t)):(ae=t||{},ie=[])}function x(){angular.extend(ue,ae),ae.classes&&(ue.classes=angular.extend({},le,ae.classes)),ae.eventNames&&(ue.eventNames=angular.extend({},ce,ae.eventNames))}function S(){p(ue.boundingBox)||(ue.boundingBox=!1),ue.containers&&(ie=ue.containers),ie=a(ie),Array.isArray(ue.containersModel)?ue.containersModel=Array.isArray(ue.containersModel[0])?ue.containersModel:[ue.containersModel]:ue.containersModel=[],Array.isArray(ue.containersFilteredModel)?ue.containersFilteredModel=Array.isArray(ue.containersFilteredModel[0])?ue.containersFilteredModel:[ue.containersFilteredModel]:ue.containersFilteredModel=[],ue.nameSpace||(ue.nameSpace=["dragularCommon"]),Array.isArray(ue.nameSpace)||(ue.nameSpace=[ue.nameSpace]),ue.nameSpace.forEach(function(r){e.containers[r]||(e.containers[r]=[],e.containersCtx[r]=[]);for(var t=ie.length,n=e.containers[r].length,o=0;t>o;o++)e.containers[r][o+n]=ie[o],e.containersCtx[r][o+n]={o:ue,m:ue.containersModel[o],fm:ue.containersFilteredModel[o]}})}function O(r){var t=r?"off":"on";n(I,t,"mouseup",A),ie.forEach(function(e){n(e,"on","mousedown",T)}),r||angular.forEach(["dragularenter","dragularleave","dragularrelease"],function(r){var t=ue.eventNames[r];e.dragOverEvents[t]||(X.createEvent?(e.dragOverEvents[t]=X.createEvent("HTMLEvents"),e.dragOverEvents[t].initEvent(t,!0,!0)):(e.dragOverEvents[t]=X.createEventObject(),e.dragOverEvents[t].eventType=t))})}function T(r){if(1===l(r)&&!r.metaKey&&!r.ctrlKey){e.moveX=r.clientX,e.moveY=r.clientY;var t=k(r.target);t&&t.item&&(e.grabbed=t,$(),"mousedown"===r.type&&(C(t.item)?t.item.focus():r.preventDefault()))}}function A(r){if(P(),se.dragging){e.clientX=M("clientX",r),e.clientY=M("clientY",r);var t=oe(e.mirror,e.clientX,e.clientY),n=U(t,e.clientX,e.clientY);n&&(e.copy&&ue.copySortSource||!e.copy||n!==e.source)?j(e.item,n):ue.removeOnSpill?z():K(),e.target=null,e.lastElementBehindCursor&&N(e.lastElementBehindCursor,e.dragOverEvents.dragularrelease,t),ue.scope&&ue.scope.$emit(ue.eventNames.dragularrelease,e.item,e.source)}}function B(r){if(!r)return!1;for(var t=ue.nameSpace.length;t--;)if(-1!==e.containers[ue.nameSpace[t]].indexOf(r))return!0;return ue.isContainer(r)?(e.tempModel=ue.isContainerModel(r),!0):(e.tempModel=null,!1)}function w(t){r.$applyAsync(function(){var r=Array.isArray(t)?t:a(t);r.forEach(function(r){angular.forEach(ue.nameSpace,function(t){var n;n=e.containers[t].indexOf(r),e.containers[t].splice(n,1),e.containersCtx[t].splice(n,1)})})})}function $(e){var r=e?"off":"on";n(I,r,"mousemove",H)}function F(e){var r=e?"off":"on";n(I,r,"selectstart",c),n(I,r,"click",c),n(I,r,"touchmove",c)}function D(){O(!0),w(ie),A({})}function H(r){if(e.grabbed&&!se.dragging){if(0===l(r))return void A({});if(!r.clientX||r.clientX!==e.moveX||!r.clientY||r.clientY!==e.moveY){if(ue.ignoreInputTextSelection){var t=M("clientX",r),n=M("clientY",r),o=X.elementFromPoint(t,n);if(C(o))return}var i=e.grabbed;if($("remove"),F(),W(),L(i),!ue.direction&&b(e.sourceItem)){var a=e.sourceItem.parentNode,c=a.offsetHeight,u=a.offsetWidth,d=e.sourceItem.clientHeight,m=e.sourceItem.clientWidth;ue.direction=u/m>c/d?"horizontal":"vertical"}var g=s(e.sourceItem);e.offsetX=M("pageX",r)-g.left,e.offsetY=M("pageY",r)-g.top,e.clientX=M("clientX",r),e.clientY=M("clientY",r),ue.boundingBox&&(e.offsetXr=M("pageX",r)-g.right,e.offsetYb=M("pageY",r)-g.bottom),r.preventDefault(),h(e.item,ue.classes.transit),_(),e.mirror.style.left=e.clientX-e.offsetX+"px",e.mirror.style.top=e.clientY-e.offsetY+"px",G(r)}}}function k(r){if(!se.dragging||!e.mirror){for(var t=r;b(r)&&!B(b(r));){if(ue.invalid(r,t))return;if(r=b(r),!r)return}var n=b(r);if(n&&!ue.invalid(r,t)&&ue.moves(r,n,t,f(r)))return{item:r,source:n}}}function R(e){var r=k(e);r&&L(r)}function L(r){e.sourceItem=e.item=r.item,e.source=r.source,e.initialSibling=e.currentSibling=f(r.item),ne(r.item,r.source)?(e.item=r.item.cloneNode(!0),e.copy=!0,ue.scope&&ue.scope.$emit(ue.eventNames.dragularcloned,e.item,r.item)):e.copy=!1;var t=ie.indexOf(r.source);return e.sourceModel=ue.containersModel[t],e.sourceFilteredModel=ue.containersFilteredModel[t],e.initialIndex=E(r.item,r.source),se.dragging=!0,ue.scope&&ue.scope.$emit(ue.eventNames.dragulardrag,e.sourceItem,e.source),!0}function W(){se.dragging&&e.item&&j(e.item,b(e.item))}function P(){e.grabbed=!1,$("remove"),F("remove")}function j(t,n){function o(){ue.scope&&(J(n)?ue.scope.$emit(ue.eventNames.dragularcancel,t,e.source,e.sourceModel,e.initialIndex):ue.scope.$emit(ue.eventNames.dragulardrop,t,n,e.source,e.sourceModel,e.initialIndex,e.targetModel,i))}if(e.copy&&ue.copySortSource&&n===e.source&&b(t)&&t.parentNode.removeChild(e.sourceItem),e.sourceModel&&!J(n)){var i=E(t,n);e.targetCtx.fm&&(i=e.targetCtx.m.indexOf(e.targetCtx.fm[i])),e.sourceFilteredModel&&(e.initialIndex=e.sourceModel.indexOf(e.sourceFilteredModel[e.initialIndex])),r.$applyAsync(function(){n===e.source?e.sourceModel.splice(i,0,e.sourceModel.splice(e.initialIndex,1)[0]):(e.dropElmModel=e.copy?angular.copy(e.sourceModel[e.initialIndex]):e.sourceModel[e.initialIndex],e.tempModel?e.targetModel=e.tempModel:e.targetModel=e.targetCtx.m,n.removeChild(t),e.copy||e.sourceModel.splice(e.initialIndex,1),e.targetModel.splice(i,0,e.dropElmModel)),b(t)&&t.parentNode.removeChild(t),o(),q()})}else o(),q()}function z(){if(se.dragging){var t=b(e.item);t&&t.removeChild(e.item),e.sourceModel&&r.$applyAsync(function(){e.sourceModel.splice(e.initialIndex,1),q()}),ue.scope&&ue.scope.$emit(e.copy?ue.eventNames.dragularcancel:ue.eventNames.dragularremove,e.item,t,e.sourceModel,e.initialIndex),e.sourceModel||q()}}function K(r){if(se.dragging){var t=arguments.length>0?r:ue.revertOnSpill,n=b(e.item),o=J(n);o||e.copy||!t||e.source.insertBefore(e.item,e.initialSibling),!e.sourceModel||e.copy||t?ue.scope&&(o||t)&&ue.scope.$emit(ue.eventNames.dragularcancel,e.item,e.source):j(e.item,n),(!e.sourceModel||e.copy||t||o)&&q()}}function q(){P(),ee(),e.item&&y(e.item,ue.classes.transit),se.dragging=!1,ue.removeOnSpill===!0&&V(),ue.scope&&(e.lastDropTarget&&ue.scope.$emit(ue.eventNames.dragularout,e.item,e.lastDropTarget,e.source),ue.scope.$emit(ue.eventNames.dragulardragend,e.item)),e.source=e.item=e.sourceItem=e.initialSibling=e.currentSibling=e.sourceModel=null,e.initialIndex=e.currentIndex=e.lastDropTarget=e.tempModel=e.targetModel=null,e.dropElmModel=e.targetCtx=e.copy=e.moveX=e.moveY=null}function J(r,t){var n=t||(e.mirror?e.currentSibling:f(e.item));return r===e.source&&n===e.initialSibling}function U(r,t,n){function o(){var o=!1;if(B(i)){for(var a=re(i,r),l=te(i,a,t,n),c=J(i,l),u=ue.nameSpace.length;u--;){if(-1!==e.containers[ue.nameSpace[u]].indexOf(i)){e.targetCtx=e.containersCtx[ue.nameSpace[u]][e.containers[ue.nameSpace[u]].indexOf(i)];break}e.targetCtx||(e.targetCtx=e.containersCtx.dragularCommon[e.containers.dragularCommon.indexOf(i)])}o=c||e.targetCtx.o.accepts(e.item,i,e.source,l,e.sourceModel,e.initialIndex)&&ue.canBeAccepted(e.item,i,e.source,l,e.sourceModel,e.initialIndex),e.target!==i&&(e.target=i)}return o}for(var i=r;i&&!o();)i=b(i);return i}function G(r){function t(r){ue.scope&&ue.scope.$emit(ue.eventNames["dragular"+r],e.item,e.lastDropTarget,e.source),ue.removeOnSpill===!0&&("over"===r?Q():V())}if(e.mirror){e.clientX=M("clientX",r),e.clientY=M("clientY",r);var n,o,i,a=e.clientX-e.offsetX,l=e.clientY-e.offsetY;ue.boundingBox&&(n=M("pageX",r),o=M("pageY",r),i=s(ue.boundingBox)),ue.lockY||(!ue.boundingBox||n>i.left+e.offsetX&&n<i.right+e.offsetXr?e.mirror.style.left=a+"px":ue.boundingBox&&(n<i.left+e.offsetX?e.mirror.style.left=e.clientX-(n-i.left)+"px":e.mirror.style.left=e.clientX-e.mirrorWidth-(n-i.right)+"px")),ue.lockX||(!ue.boundingBox||o>i.top+e.offsetY&&o<i.bottom+e.offsetYb?e.mirror.style.top=l+"px":ue.boundingBox&&(o<i.top+e.offsetY?e.mirror.style.top=e.clientY-(o-i.top)+"px":e.mirror.style.top=e.clientY-e.mirrorHeight-(o-i.bottom)+"px"));var c=oe(e.mirror,e.clientX,e.clientY),u=U(c,e.clientX,e.clientY),d=u!==e.lastDropTarget;if(c!==e.lastElementBehindCursor&&(N(c,e.dragOverEvents.dragularenter,!!u),e.lastElementBehindCursor&&N(e.lastElementBehindCursor,e.dragOverEvents.dragularleave,c),e.lastElementBehindCursor=c),d&&(e.lastDropTarget&&t("out"),e.lastDropTarget=u,t("over")),u===e.source&&e.copy&&!ue.copySortSource)return void(b(e.item)&&e.item.parentNode.removeChild(e.item));var m,g=re(u,c);if(null!==g)m=te(u,g,e.clientX,e.clientY);else{if(ue.revertOnSpill!==!0||e.copy)return void(e.copy&&b(e.item)&&e.item.parentNode.removeChild(e.item));m=e.initialSibling,u=e.source}(null===m||m!==e.item&&m!==f(e.item)&&m!==e.currentSibling)&&(e.currentSibling=m,u.insertBefore(e.item,m),ue.scope&&ue.scope.$emit(ue.eventNames.dragularshadow,e.item,u))}}function Q(){y(e.item,ue.classes.hide)}function V(){se.dragging&&h(e.item,ue.classes.hide)}function Z(r){if(e.target){var t=e.target.scrollTop;e.target.scrollTop+=r.deltaY,t!==e.target.scrollTop&&(r.stopPropagation(),r.preventDefault())}}function _(){if(!e.mirror){var r=e.sourceItem.getBoundingClientRect();e.mirror=e.sourceItem.cloneNode(!0),e.mirrorWidth=r.width,e.mirrorHeight=r.height,e.mirror.style.width=d(r)+"px",e.mirror.style.height=m(r)+"px",y(e.mirror,ue.classes.transit),h(e.mirror,ue.classes.mirror),ue.mirrorContainer.appendChild(e.mirror),n(I,"on","mousemove",G),h(Y,ue.classes.unselectable),n(e.mirror,"on","wheel",Z),ue.scope&&ue.scope.$emit(ue.eventNames.dragularcloned,e.mirror,e.sourceItem)}}function ee(){e.mirror&&(y(Y,ue.classes.unselectable),n(I,"off","mousemove",G),n(e.mirror,"off","wheel",Z),b(e.mirror)&&e.mirror.parentNode.removeChild(e.mirror),e.mirror=null)}function re(e,r){for(var t=r;t!==e&&b(t)!==e;)t=b(t);return t===I?null:t}function te(e,r,t,n){function o(){var r,o,i,a=e.children.length;for(r=0;a>r;r++){if(o=e.children[r],i=o.getBoundingClientRect(),l&&i.left>t)return o;if(!l&&i.top>n)return o}return null}function i(){var e=r.getBoundingClientRect();return a(l?t>e.left+d(e)/2:n>e.top+m(e)/2)}function a(e){return e?f(r):r}var l="horizontal"===ue.direction;return r!==e?i():o()}function ne(e,r){return"boolean"==typeof ue.copy?ue.copy:ue.copy(e,r)}function oe(e,r,t){var n,o=e||{},i=o.className;return o.className+=" "+ue.classes.hide,n=X.elementFromPoint(r,t),o.className=i,n}var ie=t||[],ae=u||{},le={mirror:"gu-mirror",hide:"gu-hide",unselectable:"gu-unselectable",transit:"gu-transit"},ce={dragularenter:"dragularenter",dragularleave:"dragularleave",dragularrelease:"dragularrelease",dragularcloned:"dragularcloned",dragulardrag:"dragulardrag",dragularcancel:"dragularcancel",dragulardrop:"dragulardrop",dragularremove:"dragularremove",dragulardragend:"dragulardragend",dragularshadow:"dragularshadow",dragularover:"dragularover",dragularout:"dragularout"},ue={classes:le,eventNames:ce,containers:!1,containersModel:!1,containersFilteredModel:!1,isContainer:o,isContainerModel:g,moves:i,accepts:i,canBeAccepted:i,copy:!1,invalid:o,revertOnSpill:!1,removeOnSpill:!1,lockX:!1,lockY:!1,boundingBox:!1,mirrorContainer:X.body,ignoreInputTextSelection:!1};v(),x(),S(),O();var se={containers:e.containers,containersCtx:e.containersCtx,isContainer:B,start:R,end:W,cancel:K,remove:z,destroy:D,dragging:!1};return se}function n(e,r,t,n){var o={mouseup:"touchend",mousedown:"touchstart",mousemove:"touchmove"},i=angular.element(e);o[t]&&i[r](o[t],n),i[r](t,n)}function o(){return!1}function i(){return!0}function a(e,r){return Array.isArray(e)?e:e.length?Array.prototype.slice.call(e,r):[e]}function l(e){if(void 0!==e.touches)return e.touches.length;if(void 0!==e.buttons)return e.buttons;if(void 0!==e.which)return e.which;var r=e.button;return void 0!==r?1&r?1:2&r?3:4&r?2:0:void 0}function c(r){e.grabbed&&r.preventDefault()}function u(e,r){return"undefined"!=typeof window[r]?window[r]:I.clientHeight?I[e]:Y[e]}function s(e){var r=e.getBoundingClientRect(),t=u("scrollTop","pageYOffset"),n=u("scrollLeft","pageXOffset");return{left:r.left+n,right:r.right+n,top:r.top+t,bottom:r.bottom+t}}function d(e){return e.width||e.right-e.left}function m(e){return e.height||e.bottom-e.top}function g(){return{}}function f(e){function r(){var r=e;do r=r.nextSibling;while(r&&1!==r.nodeType);return r}return e.nextElementSibling||r()}function p(e){return"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName}function v(r){var t=e.classesCache[r];return t?t.lastIndex=0:e.classesCache[r]=t=new RegExp("(?:^|\\s)"+r+"(?:\\s|$)","g"),t}function h(e,r){var t=e.className;t.length?v(r).test(t)||(e.className+=" "+r):e.className=r}function y(e,r){e.className=e.className.replace(v(r)," ").trim()}function x(e){return e.targetTouches&&e.targetTouches.length?e.targetTouches[0]:e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e}function M(e,r){var t=x(r),n={pageX:"clientX",pageY:"clientY"};return e in n&&!(e in t)&&n[e]in t&&(e=n[e]),!t.type||t.type.indexOf("touch")<0?t[e]:-1===t.type.indexOf("end")?t.originalEvent.touches[0][e.replace("client","page")]:!1}function b(e){return e.parentNode===document?null:e.parentNode}function C(e){return"INPUT"===e.tagName||"TEXTAREA"===e.tagName||"SELECT"===e.tagName||S(e)}function S(e){return e?"false"===e.contentEditable?!1:"true"===e.contentEditable?!0:S(b(e)):!1}function E(e,r){return Array.prototype.indexOf.call(angular.element(r).children(),e)}function N(r,t,n){r&&(e.extra=n,r.dispatchEvent?r.dispatchEvent(t):r.fireEvent("on"+t.eventType,t))}var X=document,Y=X.body,I=X.documentElement;return t.cleanEnviroment=function(){e.classesCache={},e.containersCtx={},e.containers={},e.mirror=void 0},t.shared=e,t}),angular.module("dragular").directive("dragular",function(e){return{restrict:"A",link:function(r,t,n){function o(e){try{return JSON.parse(e)}catch(r){return}}var i=r.$eval(n.dragular)||o(n.dragular)||{};n.dragularModel?i=angular.extend({containersModel:r.$eval(n.dragularModel)},i):i&&i.containersModel&&"string"==typeof i.containersModel&&(i.containersModel=r.$eval(i.containersModel)),e(t[0],i)}}})}();